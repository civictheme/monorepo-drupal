langcode: en
status: true
dependencies:
  enforced:
    module:
      - civictheme_migrate
id: civictheme_page_migrate
class: null
field_plugin_method: null
cck_plugin_method: null
migration_tags:
  - civictheme_migrate
migration_group: civictheme_migrate
label: 'CivicTheme Page Migration'
source:
  plugin: url
  data_fetcher_plugin: file
  data_parser_plugin: json
  # URLs are the uploaded or remote files fetched during migration generation.
  # This contains the stream wrappers of the locally hosted files.
  #  urls:
  fields:
    - name: id
      label: "ID"
      selector: id
    - name: title
      label: "Title"
      selector: title
    - name: alias
      label: "Path alias"
      selector: alias
    - name: summary
      label: "Summary"
      selector: summary
    - name: vertical_spacing
      label: "Vertical Spacing"
      selector: vertical_spacing
    - name: thumbnail_id
      label: "Thumbnail id"
      selector: thumbnail/id
    - name: featured_image_id
      label: "Featured image id"
      selector: banner/featured_image/id
    - name: banner_background_id
      label: "Banner background image id"
      selector: banner/background/id
    - name: hide_sidebar
      label: "Hide sidebar"
      selector: hide_sidebar
    - name: show_last_updated_date
      label: "Show last updated date"
      selector: show_last_updated_date
    - name: banner_title
      label: "Banner title"
      selector: banner/title
    - name: banner_type
      label: "Banner type"
      selector: banner/banner_type
    - name: banner_blend_mode
      label: "Vertical Spacing"
      selector:  banner/blend_mode
  ids:
    id:
      type: string
process:
  title:
    - plugin: skip_on_empty
      source: title
      method: row
      message: 'Title is empty'
    -
      plugin: substr
      length: 255
  field_c_n_summary: summary
  field_c_n_vertical_space: vertical_spacing
  field_c_n_hide_sidebar: hide_sidebar
  field_c_n_thumbnail:
    plugin: migration_lookup
    migration: civictheme_media_image__thumbnail
    source: thumbnail_id
  field_c_n_show_last_updated: show_last_updated_date
  field_c_n_banner_title: banner_title
  field_c_n_banner_type: banner_type
  field_c_n_blend_mode: banner_blend_mode
  field_c_n_custom_last_updated: last_updated_date
  field_c_n_banner_featured_image:
    plugin: migration_lookup
    migration: civictheme_media_image__featured_image
    source: featured_image_id
  field_c_n_banner_background:
    plugin: migration_lookup
    migration: civictheme_media_image__banner_background
    source: banner_background_id
  'path/pathauto':
    plugin: default_value
    default_value: 0
  'path/alias': alias

destination:
  plugin: 'entity:node'
  default_bundle: civictheme_page
migration_dependencies:
  required:
    - civictheme_media_image__thumbnail
    - civictheme_media_image__featured_image
    - civictheme_media_image__banner_background
